<div class="container mb-3">
  <div class="row">
    <div class="col-md-12">
      <div class="card shadow-sm">
        <form #form="ngForm">
          <div class="card-header">
            <h5 *ngIf="!userId">Dodaj użytkownika</h5>
            <h5 *ngIf="userId"> Edytuj użytkownika</h5>
          </div>
          <div class="card-body">
            <div class="form-group row">
              <label for="firstNameUserMode" class="col-sm-2 col-form-label">Imię</label>
              <div class="col-sm-10">
                <input type="text" required class="form-control"
                  [ngClass]="{'is-invalid': form.submitted && firstNameRef.invalid}" id="firstNameUserMode"
                  aria-describedby="emailHelp" name="firstName" [(ngModel)]="user.firstName" #firstNameRef="ngModel">
                <div class="invalid-feedback" *ngIf="form.submitted && firstNameRef.invalid">
                  Imie jest wymagany
                </div>
              </div>
            </div>
            <div class="form-group row">
              <label for="lastNameUserMode" class="col-sm-2 col-form-label">Nazwisko</label>
              <div class="col-sm-10">
                <input type="text" required class="form-control"
                  [ngClass]="{'is-invalid': form.submitted && lastNameRef.invalid}" id="lastNameUserMode"
                  aria-describedby="emailHelp" name="lastName" [(ngModel)]="user.lastName" #lastNameRef="ngModel">
                <div class="invalid-feedback" *ngIf="form.submitted && lastNameRef.invalid">
                  Nazwisko jest wymagany
                </div>
              </div>
            </div>
            <div class="form-group row">
              <label for="cityUserMode" class="col-sm-2 col-form-label">Miasto</label>
              <div class="col-sm-10">
                <input type="text" required class="form-control"
                  [ngClass]="{'is-invalid': form.submitted && cityRef.invalid}" id="cityUserMode"
                  aria-describedby="emailHelp" name="city" [(ngModel)]="user.city" #cityRef="ngModel">
                <div class="invalid-feedback" *ngIf="form.submitted && cityRef.invalid">
                  Miasto jest wymagany
                </div>
              </div>
            </div>
            <div class="form-group row">
              <label for="countryUserMode" class="col-sm-2 col-form-label">Państwo</label>
              <div class="col-sm-10">
                <input type="text" required class="form-control"
                  [ngClass]="{'is-invalid': form.submitted && countryRef.invalid}" id="countryUserMode"
                  aria-describedby="emailHelp" name="country" [(ngModel)]="user.country" #countryRef="ngModel">
                <div class="invalid-feedback" *ngIf="form.submitted && countryRef.invalid">
                  Państwo jest wymagany
                </div>
              </div>
            </div>
            <div class="form-group row">
              <label for="mailUserMode" class="col-sm-2 col-form-label">Adres E-mail</label>
              <div class="col-sm-10">
                <input type="email" required pattern="[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,3}$" class="form-control"
                  [ngClass]="{'is-invalid': form.submitted && mailRef.invalid}" id="mailUserMode"
                  aria-describedby="emailHelp" name="mail" [(ngModel)]="user.mail" #mailRef="ngModel">
                <div class="invalid-feedback" *ngIf="form.submitted && mailRef.invalid && mailRef?.errors.required">
                  Adres E-mail jest wymagany
                </div>
                <div class="invalid-feedback" *ngIf="form.submitted && mailRef.invalid && mailRef?.errors.pattern">
                  Niepoprawny adres E-mail
                </div>
              </div>
            </div>
            <div class="form-group row">
              <label for="roleUserMode" class="col-sm-2 col-form-label">Rola użytkownika</label>
              <div class="col-sm-10">
                <select class="form-control" id="roleUserMode" name="role" [(ngModel)]="user.role">
                  <option value="Użytkownik">Użytkownik</option>
                  <option value="Administrator">Administrator</option>
                </select>
              </div>
            </div>
            <div class="form-group row">
              <label for="passwdUserMode" class="col-sm-2 col-form-label">Hasło</label>
              <div class="col-sm-8">
                <input type="password" autocomplete="password" class="form-control" required
                  [ngClass]="{'is-invalid': form.submitted && passwordRef.invalid || (form.submitted && user.password !== user.repeatPassword)}"
                  id="passwdUserMode" name="password" [(ngModel)]="user.password" #passwordRef="ngModel">
                <div class="invalid-feedback" *ngIf="form.submitted && passwordRef.invalid">
                  Hasło jest wymagane
                </div>
              </div>
              <div class="col-sm-2">
                <button type="button" class="btn btn-outline-dark" (click)="onGeneratePasswordClick()">Wygeneruj
                  hasło</button>
              </div>
            </div>
            <div class="form-group row">
              <label for="rPasswdUserMode" class="col-sm-2 col-form-label">Powtórz hasło</label>
              <div class="col-sm-10">
                <input type="password" required
                  [ngClass]="{'is-invalid': form.submitted && passwordRef.invalid || (form.submitted && user.password !== user.repeatPassword)}"
                  autocomplete="repeat-password" class="form-control" id="rPasswdUserMode" name="repeatPassword"
                  [(ngModel)]="user.repeatPassword" #repeatPasswordRef="ngModel">
                <div class="invalid-feedback" *ngIf="form.submitted && repeatPasswordRef.invalid">
                  Potwierdzenie hasła jest wymagane
                </div>
                <div class="invalid-feedback" *ngIf="form.submitted && user.password !== user.repeatPassword">
                  Hasła różnią się
                </div>
              </div>
            </div>
          </div>
          <div class="card-footer text-muted">
            <button type="button" class="btn btn-outline-dark" *ngIf="!userId" (click)="onCreateUserClick(form)">Utwórz</button>
            <button type="button" class="btn btn-outline-dark" *ngIf="userId">Edytuj</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
